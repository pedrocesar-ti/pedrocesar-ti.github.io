<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>node-teamcity-api | Pedro César de Azevedo!</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.4.3">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    
        <link rel="stylesheet" href="../docs/styles/website.css">
    

        
    
    
    
    <link rel="prev" href="../docs/jmeter-docker.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="17" data-basepath=".." data-revision="Sat May 19 2018 06:54:42 GMT+0000 (UTC)">
    

<div class="book-summary">
    <div class="book-search" role="search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="docs/internet-speedtest-docker.html">
            
                
                    <a href="../docs/internet-speedtest-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        internet-speedtest-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="docs/hubot-slack-docker.html">
            
                
                    <a href="../docs/hubot-slack-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        hubot-slack-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="docs/rasp-iot-bot.html">
            
                
                    <a href="../docs/rasp-iot-bot.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        rasp-iot-bot
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="docs/machine.html">
            
                
                    <a href="../docs/machine.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        machine
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="docs/bash-facilities.html">
            
                
                    <a href="../docs/bash-facilities.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        bash-facilities
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="docs/Vimfiles.html">
            
                
                    <a href="../docs/Vimfiles.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Vimfiles
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="docs/shellscripting.html">
            
                
                    <a href="../docs/shellscripting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        shellscripting
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="docs/my-alexa-skills.html">
            
                
                    <a href="../docs/my-alexa-skills.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        my-alexa-skills
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="docs/javascript-mean-docker.html">
            
                
                    <a href="../docs/javascript-mean-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        javascript-mean-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="docs/jenkins-docker-slave.html">
            
                
                    <a href="../docs/jenkins-docker-slave.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        jenkins-docker-slave
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="docs/snm-cm-docker.html">
            
                
                    <a href="../docs/snm-cm-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        monitor-stack-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="docs/janky-docker.html">
            
                
                    <a href="../docs/janky-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        janky-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="docs/slate-docker.html">
            
                
                    <a href="../docs/slate-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        slate-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="docs/puppet-br-certification.html">
            
                
                    <a href="../docs/puppet-br-certification.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        puppet-br-certification
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="docs/puppet-br.org-octopress.html">
            
                
                    <a href="../docs/puppet-br.org-octopress.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        puppet-br
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="docs/jmeter-docker.html">
            
                
                    <a href="../docs/jmeter-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        jmeter-docker
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="17" data-path="docs/node-teamcity-api.html">
            
                
                    <a href="../docs/node-teamcity-api.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        node-teamcity-api
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Pedro César de Azevedo!</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="node-js-teamcity-rest-api-library">Node.js TeamCity REST API Library</h1>
<p>A Node.js API wrapper around the TeamCity RESTful API to make it easy to use.</p>
<h2 id="installation">Installation</h2>
<p>To use the library in Node.js, install it using npm:</p>
<p><code>npm install teamcity-rest-api</code></p>
<h2 id="api-style">API Style</h2>
<p>This library has been writtne to support Node.js 4.x and native promises, 
there are no callbacks from any of the functions.</p>
<h1 id="examples">Examples</h1>
<h2 id="creating-the-client">Creating the Client</h2>
<p>You can instantiate the API client using the <code>create()</code> function with a
<code>URL</code> or <code>configuration</code> object.</p>
<p>If you use the <code>URL</code>, you will be connected to the <code>guest</code> RESTful API endpoints.
This will require that you have guest access turned on in the TeamCity Server
that you are connecting to. Note that not all endpoints are accessible
via the <code>guest</code> API.</p>
<h3 id="connecting-using-a-url">Connecting Using a URL</h3>
<pre><code class="lang-js">var teamcity = require(&quot;teamcity-rest-api&quot;);

var client = teamcity.create(&apos;http://localhost:8111&apos;)
</code></pre>
<h3 id="connecting-using-a-configuration-object">Connecting Using a Configuration Object</h3>
<p>You must use the <code>configuration</code> object if you need to connect to the authenticated
RESTful API endpoints. The <code>configuration</code> object allows you to pass in the
username and password values.</p>
<p>The <code>configuration</code> object can have a number of properties which consist of:</p>
<ul>
<li><code>url</code> The full URL for the TeamCity server, e.g. <a href="http://teamcity.domain.com:8111" target="_blank">http://teamcity.domain.com:8111</a></li>
<li><code>protocol</code> The protocol for the connection, e.g. http</li>
<li><code>hostname</code> The hostname of the server, e.g. teamcity.domain.com</li>
<li><code>port</code> The port for the TeamCity server, e.g. 8111</li>
<li><code>username</code> The username if using authenticated endpoints</li>
<li><code>password</code> The password for the user you are authenticating as</li>
</ul>
<p>You can specify a full <code>url</code> or the combination of <code>protocol</code>, <code>hostname</code> 
and an optional <code>port</code> depending upon your needs. If you choose to provide a
<code>url</code> along with any other parameters, the <code>url</code> will be used and the others
ignored.</p>
<p>If no authentication details are provided (<code>username</code> and <code>password</code>) the 
connection to TeamCity will be performed as a guest. This will require
guest access to be turned on in the TeamCity Server. If using guest access, 
some API endpoints may be unavailable, based on the access settings of the TeamCity Server.</p>
<p>User authentication details can be provided using <code>user</code> or <code>username</code> for the 
username to connect as and <code>password</code> or <code>pass</code> for the password for the user. Both a 
username and password must be provided for the API to attempt to connect with the 
TeamCity server, otherwise it will fall back to using a guest connection.</p>
<p>Connecting to the TeamCity server with a <code>url</code> parameter:</p>
<pre><code class="lang-js">var teamcity = require(&quot;teamcity-rest-api&quot;);

var client = teamcity.create({
    url: &quot;http://localhost:8111&quot;,
    username: &quot;user&quot;,
    password: &quot;pass&quot;
});
</code></pre>
<p>Connecting to the TeamCity server with a <code>protocol</code>, <code>hostname</code> and <code>port</code>:</p>
<pre><code class="lang-js">var teamcity = require(&quot;teamcity-rest-api&quot;);

var client = teamcity.create({
    url: &quot;http://localhost:8111&quot;,
    username: &quot;user&quot;,
    password: &quot;pass&quot;
});
</code></pre>
<h2 id="teamcity-version-numbers">TeamCity Version Numbers</h2>
<p>The TeamCity Server has two version numbers that it can report once connected. These are available as a guest or an
authenticated user.</p>
<p>The two version numbers are that of the TeamCity Server software and the other being that of the RESTful API version.</p>
<h3 id="getting-the-teamcity-version">Getting the TeamCity Version</h3>
<pre><code class="lang-js">var teamcity = require(&quot;teamcity-rest-api&quot;)
  , client = teamcity.create(&quot;http://localhost:8111&quot;)
  ;

client.getVersion()
  .then(function(version) {
    console.log(&quot;TeamCity Server version: &quot; + version);
  })
  .catch(function(err) {
    console.error(err.message);
  });
</code></pre>
<h3 id="teamcity-api-version">TeamCity API Version</h3>
<p>The API version is a major.minor version number as a string that matches
the version of TeamCity, e.g. for 9.1.4 it is &quot;9.1&quot;.</p>
<pre><code class="lang-js">var teamcity = require(&quot;teamcity-rest-api&quot;)
  , client = teamcity.create(&quot;http://localhost:8111&quot;)
  ;

client.getApiVersion()
  .then(function(version) {
    console.log(&quot;TeamCity Server version: &quot; + version);
  })
  .catch(function(err) {
    console.error(err.message);
  });
</code></pre>
<h2 id="projects">Projects</h2>
<p>The API provides a <code>project</code> object for interacting with various Project
related activities.</p>
<h3 id="teamcity-projects-create-create-a-project">teamcity.projects.create - Create a Project</h3>
<p>To create a project use the <code>client.projects.create()</code> function:</p>
<pre><code class="lang-js">var teamcity = require(&quot;teamcity-rest-api&quot;)
  , client = teamcity.create({
    url: &quot;http://localhost:8111&quot;,
    username: &quot;user&quot;,
    password: &quot;pass&quot;
  })
  ;

client.projects.create()
  .then(function(project) {
    console.log(JSON.stringify(project, null, 2));
  })
  .catch(function(err) {
    console.error(err.message);
  });
</code></pre>
<h2 id="builds">Builds</h2>
<p>The API provides a <code>builds</code> object to interact with Build Configurations.</p>
<h3 id="teamcity-builds-get-get-a-specific-build">teamcity.builds.get - Get a specific build</h3>
<pre><code class="lang-js">client.builds.get({id: 100})
  .then(function(build) {
    console.log(build.state)
  });
</code></pre>
<h3 id="teamcity-builds-getbybuildtypewithcount-and-getbyprojectwithcount-get-a-list-of-builds-for-a-configuration">teamcity.builds.getByBuildTypeWithCount and getByProjectWithCount - Get a list of builds for a configuration</h3>
<p>These methods provide different ways to get a list of builds of a specific build configuration.
To list builds by the name or ID of a build config, use <code>getByBuildTypeWithCount</code>.
To list builds for a particular project, use <code>getByProjectWithCount</code>.
Both of these methods do not apply default filtering from TeamCity, so you will get in-progress builds as well.</p>
<pre><code class="lang-js">client.builds.getByBuildTypeWithCount({id: &quot;BuildConfigId&quot;}, {dimensions: {count:10}})
  .then(function(buildList){
    console.log(buildList.build[0]) //buildList.build is an array of builds, from most recent to the count parameter
  });

client.builds.getByProjectWithCount({name: &quot;TestBuildProject&quot;}, {dimensions: {count:10}})
  .then(function(buildList){
    console.log(buildList.build[0].id) //build id can be passed to builds.get for more detailed info
  });
</code></pre>
<p>The TeamCity API documentation has more examples of dimensions that can be passed into these lookups.</p>
<h3 id="teamcity-builds-startbuild-run-a-build-configuration">teamcity.builds.startBuild - Run a build configuration.</h3>
<p>This method allows you to start a build configuration; It&apos;ll return the build number of the running build.</p>
<pre><code class="lang-js">var buildNodeObject = &quot;<build> <buildType id="\&quot;TestConfigId\&quot;"> </buildType></build>&quot;
client.builds.startBuild(buildNodeObject)
  .then(function(buildStatus) {
    console.log(buildStatus.id)
  });
</code></pre>
<p>Refer to the TeamCity REST API documentation for more info on what can be passed as a buildNode.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../docs/jmeter-docker.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: jmeter-docker"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-github/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"github":{"url":"https://github.com/pedrocesar-ti"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
