<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Xenv-jenkins-lib | Pedro CÃ©sar de Azevedo!</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.4.3">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
    
        <link rel="stylesheet" href="../docs/styles/website.css">
    

        
    
    
    <link rel="next" href="../docs/hubot-slack-docker.html" />
    
    
    <link rel="prev" href="../docs/internet-speedtest-docker.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="2" data-basepath=".." data-revision="Wed Apr 17 2019 10:36:48 GMT+0000 (UTC)">
    

<div class="book-summary">
    <div class="book-search" role="search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="docs/internet-speedtest-docker.html">
            
                
                    <a href="../docs/internet-speedtest-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        internet-speedtest-docker
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2" data-path="docs/Xenv-jenkins-lib.html">
            
                
                    <a href="../docs/Xenv-jenkins-lib.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Xenv-jenkins-lib
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="docs/hubot-slack-docker.html">
            
                
                    <a href="../docs/hubot-slack-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        hubot-slack-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="docs/machine.html">
            
                
                    <a href="../docs/machine.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        machine
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="docs/bash-facilities.html">
            
                
                    <a href="../docs/bash-facilities.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        bash-facilities
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="docs/Vimfiles.html">
            
                
                    <a href="../docs/Vimfiles.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Vimfiles
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="docs/jmeter-docker.html">
            
                
                    <a href="../docs/jmeter-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        jmeter-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="docs/my-alexa-skills.html">
            
                
                    <a href="../docs/my-alexa-skills.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        my-alexa-skills
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="docs/rasp-iot-bot.html">
            
                
                    <a href="../docs/rasp-iot-bot.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        rasp-iot-bot
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="docs/shellscripting.html">
            
                
                    <a href="../docs/shellscripting.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        shellscripting
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="docs/javascript-mean-docker.html">
            
                
                    <a href="../docs/javascript-mean-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        javascript-mean-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="docs/jenkins-docker-slave.html">
            
                
                    <a href="../docs/jenkins-docker-slave.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        jenkins-docker-slave
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="docs/snm-cm-docker.html">
            
                
                    <a href="../docs/snm-cm-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        monitor-stack-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="docs/janky-docker.html">
            
                
                    <a href="../docs/janky-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        janky-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="docs/slate-docker.html">
            
                
                    <a href="../docs/slate-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        slate-docker
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="docs/puppet-br-certification.html">
            
                
                    <a href="../docs/puppet-br-certification.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        puppet-br-certification
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="17" data-path="docs/puppet-br.org-octopress.html">
            
                
                    <a href="../docs/puppet-br.org-octopress.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        puppet-br
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="18" data-path="docs/node-teamcity-api.html">
            
                
                    <a href="../docs/node-teamcity-api.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>18.</b>
                        
                        node-teamcity-api
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="19" data-path="docs/charts.html">
            
                
                    <a href="../docs/charts.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>19.</b>
                        
                        charts
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="20" data-path="docs/distributed-jmeter-docker.html">
            
                
                    <a href="../docs/distributed-jmeter-docker.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                        distributed-jmeter-docker
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Pedro CÃ©sar de Azevedo!</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="xenv-jenkins-lib">Xenv-jenkins-lib</h1>
<p>For those who are:</p>
<ol>
<li>Sick managing different versions of NodeJS, Python or Ruby in your Jenkins Pipelines</li>
<li>Struggling getting NVM, RVM and virtualenv working in your pipeline</li>
<li>Or just having a bad time setting up a bunch of plugins</li>
</ol>
<p>I HAVE EXCITING NEWS FOR YOU!!! </p>
<p>Using the power of:</p>
<ul>
<li><a href="https://jenkins.io/doc/book/pipeline/shared-libraries/" target="_blank">Jenkins Shared Libraries</a></li>
<li><a href="https://github.com/nodenv/nodenv" target="_blank">nodenv</a></li>
<li><a href="https://github.com/pyenv/pyenv" target="_blank">pyenv</a></li>
<li><a href="https://github.com/rbenv/rbenv" target="_blank">rbenv</a></li>
</ul>
<p>I created this small library that allow you to import to your pipeline  methods that do all the heavy lifting on installing the tools and different versions of NodeJS, Ruby and Python (like meta-runners).</p>
<p>The main goal is something simple like this:</p>
<pre><code class="lang-groovy">script {
    withNodenv(&apos;0.12.14&apos;) {
      sh &quot;node --version&quot;     \\ Output:  v0.12.14
    }
}
</code></pre>
<p>Have a look on some <a href="examples">Examples</a>.</p>
<h3 id="-installing">&quot;Installing&quot;</h3>
<p>You have couple options to import the module and start using you can import dinamically on each of your pipelines or you can import globally in your Jenkins server and all pipelines can import just as a single <code>Library</code>.</p>
<h4 id="importing-dynamically">Importing dynamically</h4>
<p>You can dynamically import the library adding this snippet at the beginning of your Jenkins file:</p>
<pre><code class="lang-groovy">library identifier: &apos;xenv-jenkins-lib@master&apos;, 
        retriever: modernSCM([$class: &apos;GitSCMSource&apos;, 
        remote: &apos;https://github.com/pedrocesar-ti/Xenv-jenkins-lib.git&apos;])
</code></pre>
<h4 id="importing-via-global-configuration">Importing via Global Configuration</h4>
<p>With the <a href="https://jenkins.io/doc/book/pipeline/shared-libraries/#global-shared-libraries" target="_blank">Global Shared Libraries</a>, we can basically import this lib globaly to be used in any pipeline. </p>
<p align="center"><img src="https://dl.dropboxusercontent.com/s/c74sr7mqgyqoo9x/Screen%20Shot%202018-09-23%20at%207.04.52%20AM.png" Jenkins="" Global"=""></p>

<p>On your <em>Jenkinsfile</em> you only need:</p>
<pre><code class="lang-groovy">@Library(&apos;xenv-jenkins-lib&apos;) _
</code></pre>
<h3 id="using">Using</h3>
<p>Please have a look in the <a href="examples">examples</a> folder to see how to use the methods exported by this lib.</p>
<h4 id="withnodenv-version-method">withNodenv(version, method)</h4>
<ul>
<li><em>version</em> is going to specify what version of NodeJS you want to run your code, default version is <em>6.14.4</em>.</li>
<li><em>method</em> is going to define if the version should be deleted (clean) after used, the default method is to keep the installed versions, so you don&apos;t need to re-install every time.</li>
</ul>
<pre><code class="lang-groovy">  script {
    withNodenv.purgeAll(&apos;nodenv&apos;)
    withNodenv(&apos;6.14.4&apos;, &apos;clean&apos;) {
      sh &quot;node --version&quot;    // v6.14.4
    }
  }
</code></pre>
<blockquote>
<p>withNodenv.purgeAll(&apos;nodenv&apos;) - this method helps deleting all versions of NodeJS.</p>
</blockquote>
<h4 id="withpyenv-version-method">withPyenv(version, method)</h4>
<ul>
<li><em>version</em> is going to specify what version of Python you want to run your code, default Python version is <em>3.7.0</em>.</li>
<li><em>method</em> is going to define if the version should be deleted (clean) after used, the default method is to keep the installed versions, so you don&apos;t need to re-install every time.</li>
</ul>
<pre><code class="lang-groovy">  script {
    withPyenv() {
      sh &quot;python --version&quot;    // Python 3.7.0
    }
  }
</code></pre>
<blockquote>
<p>withPyenv.purgeAll(&apos;pyenv&apos;) - this method helps deleting all versions of Python.</p>
</blockquote>
<h4 id="withrbenv-version-method">withRbenv(version, method)</h4>
<ul>
<li><em>version</em> is going to specify what version of Ruby you want to run your code, default Ruby version is <em>2.5.1</em>.</li>
<li><em>method</em> is going to define if the version should be deleted (clean) after used, the default method is to keep the installed versions, so you don&apos;t need to re-install every time.</li>
</ul>
<pre><code class="lang-groovy">  script {
    withRbenv(&apos;2.3.0&apos;) {
      sh &quot;ruby --version&quot;    // ruby 2.3.0p0
    }
  }
</code></pre>
<blockquote>
<p>withRbenv.purgeAll(&apos;rbenv&apos;) - this method helps deleting all versions of Ruby.</p>
</blockquote>
<p>Enjoy! :)</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../docs/internet-speedtest-docker.html" class="navigation navigation-prev " aria-label="Previous page: internet-speedtest-docker"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../docs/hubot-slack-docker.html" class="navigation navigation-next " aria-label="Next page: hubot-slack-docker"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-github/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2},"github":{"url":"https://github.com/pedrocesar-ti"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
